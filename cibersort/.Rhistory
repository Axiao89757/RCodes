version
quit()
load("E:/Axiao/Project/R/cibersort/.RData")
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
theme_bw()
library(dplyr)
library(tidyr)
library(tibble)
library(reshape2)
library(ggplot2)
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(col = "white") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(fill = "white") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value)) +
geom_violin(fill = Group) +
coord_flip() +
geom_boxplot(width = .2) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value)) +
geom_violin(fill = Group) +
coord_flip() +
geom_boxplot(width = .2, fill = Group) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value)) +
geom_violin(fill = vl.data$Group) +
coord_flip() +
geom_boxplot(width = .2) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2, position = position_dodge(0.9)) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2, position = position_dodge(0.9), color = "white") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2, position = position_dodge(0.9), fill = "white") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2, position = position_dodge(0.9), fill = vl.data$Group) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .2, position = position_dodge(0.9), color = "black") +
theme_bw()
?geom_boxplot
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .1, position = position_dodge(0.9), color = "black") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .1, position = position_dodge(0.9), color = "black") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .1, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.1), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(1), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.5), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = "doge2", color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(o.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.8), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.85), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin(trim = FALSE) +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin(trim = FALSE) +
coord_flip() +
geom_boxplot(size = .5, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin(trim = FALSE) +
coord_flip() +
geom_boxplot(size = .1, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
scale_fill_manual(values = c("#56B4E9", "#E69F00"))+ #设置填充的颜色
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
coord_polar()+
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
geom_violin() +
coord_flip() +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
theme_bw()
setwd("E:\\Axiao\\Project\\R\\cibersort")
library(tidybayes)
library(tidybayes)
install.packages("tidybayes")
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left", width = 0.4) +
stat_halfeye(data = vl.data[Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right", width = 0.4) +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
theme_bw()
?stat_halfeye
library(tidybayes)
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left", width = 0.4) +
stat_halfeye(data = vl.data[Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right", width = 0.4) +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left", width = 0.4) +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right", width = 0.4) +
geom_boxplot(width = .5, position = position_dodge(0.9), color = "black") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left", width = 0.4) +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right", width = 0.4) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right", width = 0.4) +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
coord_flip() +
theme_bw()
?summarySE
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
boxplot(position = position_dodge(0.5))
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
boxplot(position = position_dodge(0.5))+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
boxplot(position=position_dodge(0.5))+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
boxplot()+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
boxplot(position=position_dodge(0.5))+
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot(position = position_dodge(0.5))
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot(position = position_dodge(0.5))+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot(position = position_dodge(0.5), width =.3)+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot(position = position_dodge(0.9), width =.3)+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot( width =.3)+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot( width =.2)+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot( width =.25)+
coord_flip() +
theme_bw()
g <- split(vl.data, "Group")
View(g)
g <- split.data.frame(vl.data, "Group")
View(g)
g <- split.data.frame(vl.data, vl.data$Group)
g
g <- split.data.frame(vl.data, vl.data$celltype)
head(g)
x
lapply(g, function(x) {
x
})
lapply(g, function(x) {
split.data.frame(x, x$Group)
})
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
x <- as.vector(temp[[1]]$value)
y <- as.vector(temp[[1]]$value)
t.test(x, y, paired = T)
})
temp <- split.data.frame(g[[1]], g[[1]]$Group)
View(temp)
x <- as.vector(temp[[1]]$value)
y <- as.vector(temp[[1]]$value)
x <- as.vector(temp[[1]]$value)
y <- as.vector(temp[[2]]$value)
t.test(x, y, paired = T)
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
x <- as.vector(temp[[1]]$value)
y <- as.vector(temp[[2]]$value)
t.test(x, y, paired = T)
})
library(car)
install.packages("car")
library(car)
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
xx <- as.vector(temp[[1]]$value)
yy <- as.vector(temp[[2]]$value)
xy <- c(xx, yy)
a <- factor(c(rep(1, length(xx)), rep(2, length(yy))))
levene.test(xy~a)
t.test(xx, yy, paired = F)
})
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
xx <- as.vector(temp[[1]]$value)
yy <- as.vector(temp[[2]]$value)
xy <- c(xx, yy)
a <- factor(c(rep(1, length(xx)), rep(2, length(yy))))
leveneTest(xy~a)
t.test(xx, yy, paired = F)
})
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
xx <- as.vector(temp[[1]]$value)
yy <- as.vector(temp[[2]]$value)
xy <- c(xx, yy)
a <- factor(c(rep(1, length(xx)), rep(2, length(yy))))
leveneTest(xy~a)
})
View(phe)
View(vl.data)
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
xx <- as.vector(temp[[1]]$value)
yy <- as.vector(temp[[2]]$value)
xy <- c(xx, yy)
a <- factor(c(rep(1, length(xx)), rep(2, length(yy))))
leveneTest(xy~a)
#t.test(xx, yy, paired = F)
aov(data = as.data.frame(x), formula = Group~value)
})
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
xx <- as.vector(temp[[1]]$value)
yy <- as.vector(temp[[2]]$value)
xy <- c(xx, yy)
a <- factor(c(rep(1, length(xx)), rep(2, length(yy))))
leveneTest(xy~a)
#t.test(xx, yy, paired = F)
aov(data = as.data.frame(x), formula = value~Group)
})
summary(aov(data = as.data.frame(x), formula = value~Group))
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
xx <- as.vector(temp[[1]]$value)
yy <- as.vector(temp[[2]]$value)
xy <- c(xx, yy)
a <- factor(c(rep(1, length(xx)), rep(2, length(yy))))
leveneTest(xy~a)
#t.test(xx, yy, paired = F)
summary(aov(data = as.data.frame(x), formula = value~Group))
})
lapply(g, function(x) {
#t.test(xx, yy, paired = F)
summary(aov(data = as.data.frame(x), formula = value~Group))
})
t.test(x=c(1:10), y = c(7:20))
lapply(g, function(x) {
temp <- split.data.frame(x, x$Group)
xx <- as.vector(temp[[1]]$value)
yy <- as.vector(temp[[2]]$value)
xy <- c(xx, yy)
a <- factor(c(rep(1, length(xx)), rep(2, length(yy))))
leveneTest(xy~a)
t.test(xx, yy)
#summary(aov(data = as.data.frame(x), formula = value~Group))
})
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot( width =.25, outlier.alpha = 0)+
coord_flip() +
theme_bw()
ggplot(vl.data, aes(x = celltype, y = value, fill = Group, alpha = .5)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left") +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right") +
geom_boxplot( width =.25, outlier.alpha = 0)+
coord_flip() +
theme_bw()
lapply(g, function(x) {
summary(as.data.frame(x))
#summary(aov(data = as.data.frame(x), formula = value~Group))
})
df <- iris[c(1, 2, 3, 4)]
DF
df
iris
df_pca <- prcomp(df)
df_pca
ggplot(vl.data, aes(x = celltype, y = value, fill = Group)) +
stat_halfeye(data = vl.data[vl.data$Group == "Non-Obese",], show_interval = FALSE, trim=FALSE,side = "left", alpha = .5) +
stat_halfeye(data = vl.data[vl.data$Group == "Obese",], show_interval = FALSE, trim=FALSE,side = "right", alpha = .5) +
geom_boxplot( width =.25, outlier.alpha = 0)+
coord_flip() +
theme_bw()
citation(ggplot)
citation(ggplot2)
citation("ggplot2")
citation("pheatmap")
